# Firestore Security Rules

## โ๏ธ ููู ุฌุฏุงู: ูุฌุจ ุฅุถุงูุฉ ูุฐู ุงูููุงุนุฏ ูุฅุตูุงุญ ูุดููุฉ ุญูุธ ุงูุจูุงูุงุช

ุงููุดููุฉ ุงูุญุงููุฉ: **"Missing or insufficient permissions"** ุนูุฏ ูุญุงููุฉ ุญูุธ ุงูุจูุงูุงุช.

### ุงูุฎุทูุงุช ุงููุทููุจุฉ:

1. ุงุฐูุจ ุฅูู [Firebase Console](https://console.firebase.google.com/)
2. ุงุฎุชุฑ ุงููุดุฑูุน: **omrarafa-c6a94**
3. ุงุฐูุจ ุฅูู **Firestore Database** โ **Rules**
4. ุงุณุชุจุฏู ุงูููุงุนุฏ ุงูุญุงููุฉ **ุจุงููุงูู** ุจุงูููุงุนุฏ ุงูุชุงููุฉ:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // ==========================================================
    // 1. ๐ฅ ูุฌููุนุฉ ุงููุณุชุฎุฏููู (users) - (ุญูุงูุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ)
    // ==========================================================
    match /users/{userId} {
      
      // ๐ 1. ูุงุนุฏุฉ ุงูุฅูุดุงุก (Create)
      // ุชุณูุญ ูููุณุชุฎุฏู ุงูุฐู ูุฏูู ุฑูุฒ ูููุฒ (Token) ูู Firebase Authุ
      // ุจุฃู ูููุดุฆ ูุณุชูุฏุงู ูู ูุฑุฉ ูุงุญุฏุฉ ููุทุ ุจุงุณุชุฎุฏุงู UID ุงูุฎุงุต ุจู ูู ID ูููุณุชูุฏ.
      allow create: if request.auth != null && request.auth.uid == userId;
      
      // ๐ 2. ูุงุนุฏุฉ ุงูุชุนุฏูู (Update) ูุงูุญุฐู (Delete)
      // ุชุณูุญ ุจุงูุชุนุฏูู ูุงูุญุฐู ููุท ุฅุฐุง ูุงู ุงููุณุชูุฏ ููุฌูุฏุงู ุจุงููุนู 
      // ูุงููุณุชุฎุฏู ูู ูุงููู. (ุงููุงุนุฏุฉ ุงูููุงุณูุฉ)
      allow update, delete: if request.auth != null && request.auth.uid == userId;
      
      // ๐ 3. ูุงุนุฏุฉ ุงููุฑุงุกุฉ (Read)
      allow read: if request.auth != null; 
    }
    
    // ==========================================================
    // 2. ๐ ููุน ุงููุชุงุจุฉ ูู ุฌููุน ุงููุฌููุนุงุช ุงูุนุงูุฉ (categories, videos)
    // ==========================================================
    
    // ูุฌููุนุฉ Categories
    match /categories/{categoryId} {
      allow read: if true; // ุงูุณูุงุญ ุจุงูุฌููุน ุจุงููุฑุงุกุฉ
      allow write: if false; // ููุน ุฌููุน ุนูููุงุช ุงููุชุงุจุฉ (ุฅุถุงูุฉุ ุชุนุฏููุ ุญุฐู)
    }
    
    // ูุฌููุนุฉ Videos
    match /videos/{videoId} {
      allow read: if true; // ุงูุณูุงุญ ุจุงูุฌููุน ุจุงููุฑุงุกุฉ
      allow write: if false; // ููุน ุฌููุน ุนูููุงุช ุงููุชุงุจุฉ (ุฅุถุงูุฉุ ุชุนุฏููุ ุญุฐู)
    }
    
    // ูุฌููุนุฉ Tests
    match /tests/{testId} {
      allow read: if request.auth != null; // ุงูุณูุงุญ ุจุงููุฑุงุกุฉ ูููุณุชุฎุฏููู ุงููุณุฌููู ุฏุฎูู
      allow write: if false; // ููุน ุฌููุน ุนูููุงุช ุงููุชุงุจุฉ (ุฅุถุงูุฉุ ุชุนุฏููุ ุญุฐู)
    }
    
    // ูุฌููุนุฉ Courses
    match /courses/{courseId} {
      allow read: if request.auth != null; // ุงูุณูุงุญ ุจุงููุฑุงุกุฉ ูููุณุชุฎุฏููู ุงููุณุฌููู ุฏุฎูู
      allow write: if false; // ููุน ุฌููุน ุนูููุงุช ุงููุชุงุจุฉ (ุฅุถุงูุฉุ ุชุนุฏููุ ุญุฐู)
    }
    
    // ==========================================================
    // 3. โ ูุงุนุฏุฉ ุงูุฑูุถ ุงูุงูุชุฑุงุถูุฉ ูุฃู ุดูุก ุขุฎุฑ
    // ==========================================================
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
```

### ููุงุญุธุงุช ูููุฉ:

- **`request.auth != null`**: ูุชุญูู ูู ุฃู ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู
- **`request.auth.uid == userId`**: ูุชุญูู ูู ุฃู ุงููุณุชุฎุฏู ูุญุงูู ุงููุตูู ูุจูุงูุงุชู ููุท
- **`allow create`**: ูุณูุญ ุจุฅูุดุงุก document ุฌุฏูุฏ ููุท ุฅุฐุง ูุงู UID ูุทุงุจู
- **`allow update, delete`**: ูุณูุญ ุจุงูุชุนุฏูู ูุงูุญุฐู ููุท ุฅุฐุง ูุงู UID ูุทุงุจู
- **`allow read`**: ูุณูุญ ุจุงููุฑุงุกุฉ ูุฃู ูุณุชุฎุฏู ูุณุฌู ุฏุฎูู
- **ุจุนุฏ ุฅุถุงูุฉ ุงูููุงุนุฏุ ุงุถุบุท ุนูู "Publish" ูุญูุธูุง** โ๏ธ
- ูุฏ ูุณุชุบุฑู ุงูุฃูุฑ ุจุถุน ุฏูุงุฆู ุญุชู ุชุตุจุญ ุงูููุงุนุฏ ูุนุงูุฉ

### ุงูุชุญูู ูู ุงูููุงุนุฏ:

ุจุนุฏ ุฅุถุงูุฉ ุงูููุงุนุฏุ ููููู ุงูุชุญูู ูููุง:
1. ุงุฐูุจ ุฅูู **Firestore Database** โ **Rules**
2. ุชุฃูุฏ ูู ุฃู ุงูููุงุนุฏ ูุทุงุจูุฉ ุชูุงูุงู ููููุฏ ุฃุนูุงู
3. ุงุถุบุท ุนูู **"Publish"**
4. ุงูุชุธุฑ ุฑุณุงูุฉ ุงููุฌุงุญ

### ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ:

1. ุชุฃูุฏ ูู ุฃู ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู ุจุงููุนู (ุงูุชุญ Console ูู ุงููุชุตูุญ)
2. ุชุฃูุฏ ูู ุฃู `auth.currentUser.uid` ูุทุงุจู `userId` ูู Firestore
3. ุชุญูู ูู console ูู ุงููุชุตูุญ ููุฃุฎุทุงุก
4. ุชุฃูุฏ ูู ุฃู Firebase Client SDK ูููุฃ ุจุดูู ุตุญูุญ
5. ุฌุฑุจ ุชุณุฌูู ุงูุฎุฑูุฌ ูุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู
6. ุชุฃูุฏ ูู ุฃู ุงูููุงุนุฏ ุชู ูุดุฑูุง (Publish) ุจูุฌุงุญ
