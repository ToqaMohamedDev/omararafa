# ğŸ—ºï¸ Ù…Ø³Ø§Ø±Ø§Øª Ø¨ÙŠØ§Ù†Ø§Øª Firebase - Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§ØªØŒ Ø§Ù„ÙƒÙˆØ±Ø³Ø§ØªØŒ ÙˆØ§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª

## ğŸ“‹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
1. [Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª (Videos)](#Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª-videos)
2. [Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª (Courses)](#Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª-courses)
3. [Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (Tests)](#Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª-tests)

---

## ğŸ¥ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª (Videos)

### ğŸ“ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø¹Ø§Ù… (Public Data)
```
videos/{videoId}
```

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹:**
```typescript
{
  id: string;                    // Ù…Ø¹Ø±Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
  title: string;                 // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
  description: string;           // ÙˆØµÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
  category: string;              // ID Ø§Ù„ØªØµÙ†ÙŠÙ
  level: string;                 // ID Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
  thumbnailUrl?: string;          // ØµÙˆØ±Ø© Ù…ØµØºØ±Ø©
  thumbnail?: string;             // ØµÙˆØ±Ø© Ù…ØµØºØ±Ø© (Ø¨Ø¯ÙŠÙ„)
  views?: number;                 // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª
  duration?: string;              // Ù…Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
  createdAt: timestamp;          // ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
  updatedAt: timestamp;          // ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
}
```

**Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:**
- âœ… **Read:** Ø§Ù„Ø¬Ù…ÙŠØ¹ (public)
- âœ… **Write:** Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·

---

### ğŸ”’ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø®Ø§Øµ (Private Data)
```
videos/{videoId}/private/source
```

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† ÙÙ‚Ø·:**
```typescript
{
  url: string;                   // Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø®Ø§Øµ (ÙŠØ­ØªØ§Ø¬ Ø§Ø´ØªØ±Ø§Ùƒ)
}
```

**Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:**
- âœ… **Read:** Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…Ø´ØªØ±ÙƒÙˆÙ† ÙÙ‚Ø·
- âœ… **Write:** Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·

**Ø§Ù„Ø´Ø±ÙˆØ· Ù„Ù„ÙˆØµÙˆÙ„:**
1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ (`request.auth != null`)
2. ÙŠÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆ ÙÙŠ `videos/{videoId}`
3. Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ `level` (ID Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©)
4. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¯ÙŠÙ‡ Ø§Ø´ØªØ±Ø§Ùƒ ØµØ§Ù„Ø­ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© (`hasValidSubscription`)

---

### ğŸ”„ ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Data Flow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ØµÙØ­Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©         â”‚
        â”‚  videos/{videoId}             â”‚
        â”‚  (title, description, etc.)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª        â”‚
        â”‚  (Ù…ØªØ§Ø­ Ù„Ù„Ø¬Ù…ÙŠØ¹)                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¶ØºØ· Ø¹Ù„Ù‰ ÙÙŠØ¯ÙŠÙˆ    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ          â”‚
        â”‚  subscriptions/{userId}       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                       â”‚
            â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Ù…Ø´ØªØ±Ùƒ        â”‚      â”‚  ØºÙŠØ± Ù…Ø´ØªØ±Ùƒ   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                       â”‚
            â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø¬Ù„Ø¨ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ  â”‚   â”‚ Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©         â”‚
    â”‚ Ø§Ù„Ø®Ø§Øµ             â”‚   â”‚ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ      â”‚
    â”‚ videos/{videoId}/  â”‚   â”‚                   â”‚
    â”‚ private/source    â”‚   â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ       â”‚
    â”‚ (VideoPlayer)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ’» Ø£Ù…Ø«Ù„Ø© Ø§Ù„ÙƒÙˆØ¯

#### Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
```typescript
// Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
const videosQuery = query(
  collection(db, "videos"), 
  orderBy("createdAt", "desc")
);
const videosSnapshot = await getDocs(videosQuery);
const videos = videosSnapshot.docs.map((doc) => ({
  id: doc.id,
  ...doc.data()
}));
```

#### Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø§Øµ (Ù„Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†)
```typescript
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø£ÙˆÙ„Ø§Ù‹
const subscriptionRef = doc(db, "subscriptions", user.uid);
const subscriptionDoc = await getDoc(subscriptionRef);

if (subscriptionDoc.exists()) {
  const data = subscriptionDoc.data();
  const endsAt = data.endsAt?.toDate();
  const isValid = endsAt > new Date();
  
  if (isValid) {
    // Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø§Øµ
    const privateSourceRef = doc(db, "videos", videoId, "private", "source");
    const privateSourceDoc = await getDoc(privateSourceRef);
    
    if (privateSourceDoc.exists()) {
      const videoUrl = privateSourceDoc.data().url;
      // Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
    }
  }
}
```

---

## ğŸ“š Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª (Courses)

### ğŸ“ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø¹Ø§Ù… (Public Data)
```
courses/{courseId}
```

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†:**
```typescript
{
  id: string;                    // Ù…Ø¹Ø±Ù Ø§Ù„ÙƒÙˆØ±Ø³
  title: string;                 // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒÙˆØ±Ø³
  description: string;           // ÙˆØµÙ Ø§Ù„ÙƒÙˆØ±Ø³
  category: string;              // ID Ø§Ù„ØªØµÙ†ÙŠÙ
  level: string;                 // ID Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
  thumbnailUrl?: string;         // ØµÙˆØ±Ø© Ù…ØµØºØ±Ø©
  thumbnail?: string;            // ØµÙˆØ±Ø© Ù…ØµØºØ±Ø© (Ø¨Ø¯ÙŠÙ„)
  videoUrl?: string;            // Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø¹Ø§Ù…)
  createdAt: timestamp;         // ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
  updatedAt: timestamp;          // ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
}
```

**Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:**
- âœ… **Read:** Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙˆÙ† ÙÙ‚Ø· (`request.auth != null`)
- âœ… **Write:** Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·

---

### ğŸ”’ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø®Ø§Øµ (Private Data)
```
courses/{courseId}/private/source
```

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† ÙÙ‚Ø·:**
```typescript
{
  url: string;                   // Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø®Ø§Øµ (ÙŠØ­ØªØ§Ø¬ Ø§Ø´ØªØ±Ø§Ùƒ)
}
```

**Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:**
- âœ… **Read:** Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…Ø´ØªØ±ÙƒÙˆÙ† ÙÙ‚Ø·
- âœ… **Write:** Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·

**Ø§Ù„Ø´Ø±ÙˆØ· Ù„Ù„ÙˆØµÙˆÙ„:**
1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ (`request.auth != null`)
2. ÙŠÙˆØ¬Ø¯ ÙƒÙˆØ±Ø³ ÙÙŠ `courses/{courseId}`
3. Ø§Ù„ÙƒÙˆØ±Ø³ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ `level` (ID Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©)
4. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¯ÙŠÙ‡ Ø§Ø´ØªØ±Ø§Ùƒ ØµØ§Ù„Ø­ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© (`hasValidSubscription`)

---

### ğŸ”„ ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Data Flow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ØµÙØ­Ø© Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„      â”‚
        â”‚  (request.auth != null)       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                       â”‚
            â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„    â”‚      â”‚  ØºÙŠØ± Ù…Ø³Ø¬Ù„    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                       â”‚
            â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª      â”‚   â”‚ Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©         â”‚
    â”‚ Ø§Ù„Ø¹Ø§Ù…Ø©            â”‚   â”‚ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„      â”‚
    â”‚ courses/{courseId} â”‚   â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª          â”‚
        â”‚  (title, description, etc.)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¶ØºØ· Ø¹Ù„Ù‰ ÙƒÙˆØ±Ø³      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ          â”‚
        â”‚  subscriptions/{userId}       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                       â”‚
            â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Ù…Ø´ØªØ±Ùƒ        â”‚      â”‚  ØºÙŠØ± Ù…Ø´ØªØ±Ùƒ   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                       â”‚
            â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø¬Ù„Ø¨ Ø±Ø§Ø¨Ø· Ø§Ù„ÙƒÙˆØ±Ø³   â”‚   â”‚ Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©         â”‚
    â”‚ Ø§Ù„Ø®Ø§Øµ             â”‚   â”‚ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ      â”‚
    â”‚ courses/{courseId}/â”‚   â”‚                   â”‚
    â”‚ private/source    â”‚   â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ       â”‚
    â”‚ (VideoPlayer)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ’» Ø£Ù…Ø«Ù„Ø© Ø§Ù„ÙƒÙˆØ¯

#### Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
```typescript
// Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª (ÙŠØ­ØªØ§Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„)
if (isAuthenticated && db) {
  const coursesQuery = query(
    collection(db, "courses"), 
    orderBy("createdAt", "desc")
  );
  const coursesSnapshot = await getDocs(coursesQuery);
  const courses = coursesSnapshot.docs.map((doc) => ({
    id: doc.id,
    ...doc.data()
  }));
}
```

#### Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø§Øµ (Ù„Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†)
```typescript
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø£ÙˆÙ„Ø§Ù‹
const subscriptionRef = doc(db, "subscriptions", user.uid);
const subscriptionDoc = await getDoc(subscriptionRef);

if (subscriptionDoc.exists()) {
  const data = subscriptionDoc.data();
  const endsAt = data.endsAt?.toDate();
  const isValid = endsAt > new Date();
  
  if (isValid && data.educationalLevelId === course.level) {
    // Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø§Øµ
    const privateSourceRef = doc(db, "courses", courseId, "private", "source");
    const privateSourceDoc = await getDoc(privateSourceRef);
    
    if (privateSourceDoc.exists()) {
      const courseUrl = privateSourceDoc.data().url;
      // Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
    }
  }
}
```

---

## ğŸ“ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (Tests)

### ğŸ“ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø¹Ø§Ù… (Public Data)
```
tests/{testId}
```

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹:**
```typescript
{
  id: string;                    // Ù…Ø¹Ø±Ù Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
  title: string;                 // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
  description: string;           // ÙˆØµÙ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
  level: string;                // ID Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
  duration: string;             // Ù…Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (Ù…Ø«Ù„ "30 Ø¯Ù‚ÙŠÙ‚Ø©")
  questions: number;           // Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
  createdAt: timestamp;        // ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
  updatedAt: timestamp;        // ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
}
```

**Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:**
- âœ… **Read:** Ø§Ù„Ø¬Ù…ÙŠØ¹ (public)
- âœ… **Write:** Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·

---

### ğŸ”’ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø®Ø§Øµ (Private Data)
```
tests/{testId}/private/content
```

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† ÙÙ‚Ø·:**
```typescript
{
  questionsData: Array<{        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
    id: number;                 // Ù…Ø¹Ø±Ù Ø§Ù„Ø³Ø¤Ø§Ù„
    question: string;           // Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„
    options: string[];          // Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
    correctAnswer: number;      // Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
    explanation?: string;       // Ø´Ø±Ø­ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  }>;
}
```

**Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:**
- âœ… **Read:** Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…Ø´ØªØ±ÙƒÙˆÙ† ÙÙ‚Ø·
- âœ… **Write:** Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·

**Ø§Ù„Ø´Ø±ÙˆØ· Ù„Ù„ÙˆØµÙˆÙ„:**
1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ (`request.auth != null`)
2. ÙŠÙˆØ¬Ø¯ Ø§Ø®ØªØ¨Ø§Ø± ÙÙŠ `tests/{testId}`
3. Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ `level` (ID Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©)
4. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¯ÙŠÙ‡ Ø§Ø´ØªØ±Ø§Ùƒ ØµØ§Ù„Ø­ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© (`hasValidSubscription`)

---

### ğŸ”„ ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Data Flow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ØµÙØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©         â”‚
        â”‚  tests/{testId}               â”‚
        â”‚  (title, description, etc.)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª        â”‚
        â”‚  (Ù…ØªØ§Ø­ Ù„Ù„Ø¬Ù…ÙŠØ¹)                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¶ØºØ· Ø¹Ù„Ù‰           â”‚
        â”‚  "Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„      â”‚
        â”‚  (request.auth != null)       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                       â”‚
            â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„    â”‚      â”‚  ØºÙŠØ± Ù…Ø³Ø¬Ù„    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                       â”‚
            â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒâ”‚   â”‚ Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©         â”‚
    â”‚ subscriptions/    â”‚   â”‚ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„      â”‚
    â”‚ {userId}          â”‚   â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ       â”‚
        â”‚  (endsAt > now &&             â”‚
        â”‚   educationalLevelId == level)â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                       â”‚
            â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Ù…Ø´ØªØ±Ùƒ        â”‚      â”‚  ØºÙŠØ± Ù…Ø´ØªØ±Ùƒ   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                       â”‚
            â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©       â”‚   â”‚ Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©         â”‚
    â”‚ tests/{testId}/    â”‚   â”‚ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ      â”‚
    â”‚ private/content    â”‚   â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©       â”‚
    â”‚ (Test Interface)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¬ÙŠØ¨      â”‚
    â”‚ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø©        â”‚
    â”‚ testResults/       â”‚
    â”‚ {resultId}         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©        â”‚
    â”‚ (Result Banner)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ’» Ø£Ù…Ø«Ù„Ø© Ø§Ù„ÙƒÙˆØ¯

#### Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
```typescript
// Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
const testsQuery = query(
  collection(db, "tests"), 
  orderBy("createdAt", "desc")
);
const testsSnapshot = await getDocs(testsQuery);
const tests = testsSnapshot.docs.map((doc) => ({
  id: doc.id,
  ...doc.data()
}));
```

#### Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø®Ø§ØµØ© (Ù„Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†)
```typescript
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø£ÙˆÙ„Ø§Ù‹
const subscriptionRef = doc(db, "subscriptions", user.uid);
const subscriptionDoc = await getDoc(subscriptionRef);

if (subscriptionDoc.exists()) {
  const data = subscriptionDoc.data();
  const endsAt = data.endsAt?.toDate();
  const isValid = endsAt > new Date();
  
  if (isValid && data.educationalLevelId === test.level) {
    // Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø®Ø§ØµØ©
    const privateContentRef = doc(db, "tests", testId, "private", "content");
    const privateContentDoc = await getDoc(privateContentRef);
    
    if (privateContentDoc.exists()) {
      const questionsData = privateContentDoc.data().questionsData;
      // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
    }
  }
}
```

---

## ğŸ” Security Rules - Ù…Ù„Ø®Øµ

### Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
```javascript
match /videos/{videoId} {
  allow read: if true;  // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹
  allow write: if isAdmin();
  
  match /private/source {
    allow read: if request.auth != null && 
                   exists(/databases/$(database)/documents/videos/$(videoId)) &&
                   get(/databases/$(database)/documents/videos/$(videoId)).data.level != null &&
                   hasValidSubscription(get(/databases/$(database)/documents/videos/$(videoId)).data.level);
    allow write: if isAdmin();
  }
}
```

### Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª
```javascript
match /courses/{courseId} {
  allow read: if request.auth != null;  // ÙŠØ­ØªØ§Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
  allow write: if isAdmin();
  
  match /private/source {
    allow read: if request.auth != null && 
                   exists(/databases/$(database)/documents/courses/$(courseId)) &&
                   get(/databases/$(database)/documents/courses/$(courseId)).data.level != null &&
                   hasValidSubscription(get(/databases/$(database)/documents/courses/$(courseId)).data.level);
    allow write: if isAdmin();
  }
}
```

### Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
```javascript
match /tests/{testId} {
  allow read: if true;  // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹
  allow write: if isAdmin();
  
  match /private/content {
    allow read: if request.auth != null && 
                   exists(/databases/$(database)/documents/tests/$(testId)) &&
                   get(/databases/$(database)/documents/tests/$(testId)).data.level != null &&
                   hasValidSubscription(get(/databases/$(database)/documents/tests/$(testId)).data.level);
    allow write: if isAdmin();
  }
}
```

---

## ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø©

| Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª | Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª | Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª |
|--------|------------|----------|------------|
| **Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©** | Ù…ØªØ§Ø­Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹ | ØªØ­ØªØ§Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ | Ù…ØªØ§Ø­Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹ |
| **Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø¹Ø§Ù…** | `videos/{videoId}` | `courses/{courseId}` | `tests/{testId}` |
| **Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø®Ø§Øµ** | `videos/{videoId}/private/source` | `courses/{courseId}/private/source` | `tests/{testId}/private/content` |
| **Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§ØµØ©** | Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (`url`) | Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (`url`) | Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (`questionsData`) |
| **ÙŠØ­ØªØ§Ø¬ Ø§Ø´ØªØ±Ø§Ùƒ** | âœ… Ù†Ø¹Ù… | âœ… Ù†Ø¹Ù… | âœ… Ù†Ø¹Ù… |
| **Security Rule** | `hasValidSubscription` | `hasValidSubscription` | `hasValidSubscription` |

---

**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:** 2024-11-23

