# ğŸ” ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù€ Firestore Security Rules

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
1. [Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©](#Ù†Ø¸Ø±Ø©-Ø¹Ø§Ù…Ø©)
2. [Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© (Helper Functions)](#Ø¯ÙˆØ§Ù„-Ù…Ø³Ø§Ø¹Ø¯Ø©)
3. [Ø­Ø±ÙƒØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (Tests Flow)](#Ø­Ø±ÙƒØ©-Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª)
4. [Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª (Courses Rules)](#Ù‚ÙˆØ§Ø¹Ø¯-Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª)
5. [Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ§Ù„ÙƒÙˆØ±Ø³Ø§Øª](#Ù…Ù‚Ø§Ø±Ù†Ø©)

---

## ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ ÙŠØ´Ø±Ø­ Ø¨Ø§Ù„ØªÙØµÙŠÙ„:
- ÙƒÙŠÙÙŠØ© Ø¹Ù…Ù„ Security Rules ÙÙŠ Firestore
- Ø­Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙÙŠ Admin Panel ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
- ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª
- Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ§Ù„ÙƒÙˆØ±Ø³Ø§Øª

---

## ğŸ”§ Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© (Helper Functions)

### 1. `hasValidSubscription(requiredLevelId)`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¯ÙŠÙ‡ Ø§Ø´ØªØ±Ø§Ùƒ Ù†Ø´Ø· Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

**Ø§Ù„Ø´Ø±ÙˆØ·:**
```javascript
1. requiredLevelId != null && requiredLevelId != ""
2. request.auth != null (Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„)
3. exists(/databases/$(database)/documents/subscriptions/$(request.auth.uid))
4. subscription.endsAt > request.time (Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ù„Ù… ÙŠÙ†ØªÙ‡)
5. subscription.educationalLevelId != null
6. subscription.educationalLevelId == requiredLevelId (Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ø±Ø­Ù„Ø©)
```

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
- Ø­Ù…Ø§ÙŠØ© Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª (`videos/{videoId}/private/source`)
- Ø­Ù…Ø§ÙŠØ© Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (`tests/{testId}/private/content`)
- Ø­Ù…Ø§ÙŠØ© Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª (`courses/{courseId}/private/source`)

### 2. `isAdmin()`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¯ÙŠÙ‡ ØµÙ„Ø§Ø­ÙŠØ§Øª Admin

**Ø§Ù„Ø´Ø±ÙˆØ·:**
```javascript
1. request.auth != null
2. exists(/databases/$(database)/documents/roles/$(request.auth.uid))
3. role == 'admin'
```

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
- Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ù‚Ø±Ø§Ø¡Ø©/ÙƒØªØ§Ø¨Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø£Ø¯Ù…Ù†
- Ø­Ù…Ø§ÙŠØ© Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø© (Create, Update, Delete)

---

## ğŸ“ Ø­Ø±ÙƒØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (Tests Flow)

### ğŸ¨ ÙÙŠ Admin Panel

#### 1ï¸âƒ£ **Ø¥Ù†Ø´Ø§Ø¡/ØªØ¹Ø¯ÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø±**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin Panel - Test Form                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©:                                   â”‚
â”‚    - title (Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±)                                  â”‚
â”‚    - description (Ø§Ù„ÙˆØµÙ)                                     â”‚
â”‚    - duration (Ø§Ù„Ù…Ø¯Ø©)                                        â”‚
â”‚    - level (ID Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©)                           â”‚
â”‚                                                              â”‚
â”‚ 2. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©:                                            â”‚
â”‚    - question (Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„)                                    â”‚
â”‚    - options[] (Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©)                             â”‚
â”‚    - correctAnswer (Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©)                     â”‚
â”‚    - explanation (Ø´Ø±Ø­ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© - Ø§Ø®ØªÙŠØ§Ø±ÙŠ)                     â”‚
â”‚                                                              â”‚
â”‚ 3. Ø¹Ù†Ø¯ Ø§Ù„Ø­ÙØ¸:                                                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Firestore Write (Admin Only)             â”‚             â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚    â”‚ Collection: tests/{testId}              â”‚             â”‚
â”‚    â”‚ Fields:                                  â”‚             â”‚
â”‚    â”‚   - title: string                        â”‚             â”‚
â”‚    â”‚   - description: string                   â”‚             â”‚
â”‚    â”‚   - duration: string                    â”‚             â”‚
â”‚    â”‚   - level: string (ID Ø§Ù„Ù…Ø±Ø­Ù„Ø©)            â”‚             â”‚
â”‚    â”‚   - questions: number                    â”‚             â”‚
â”‚    â”‚   - createdAt: timestamp                â”‚             â”‚
â”‚    â”‚   - updatedAt: timestamp                 â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Subcollection:                           â”‚             â”‚
â”‚    â”‚   tests/{testId}/private/content        â”‚             â”‚
â”‚    â”‚ Fields:                                  â”‚             â”‚
â”‚    â”‚   - questionsData: array[Question]       â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Security Rules Check:**
```javascript
match /tests/{testId} {
  allow write: if isAdmin(); // âœ… Admin ÙÙ‚Ø· ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„ÙƒØªØ§Ø¨Ø©
}
```

#### 2ï¸âƒ£ **Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙÙŠ Admin Panel**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin Panel - Tests List                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Firestore Read                            â”‚             â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚    â”‚ Collection: tests                        â”‚             â”‚
â”‚    â”‚ Query: getAllDocs()                      â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Security Rules:                          â”‚             â”‚
â”‚    â”‚   allow read: if true; âœ… Ù„Ù„Ø¬Ù…ÙŠØ¹          â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                              â”‚
â”‚ 2. Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„):                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Firestore Read                            â”‚             â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚    â”‚ Path: tests/{testId}/private/content    â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Security Rules:                          â”‚             â”‚
â”‚    â”‚   allow read: if isAdmin(); âœ… Admin ÙÙ‚Ø·  â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                              â”‚
â”‚ 3. Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:                                            â”‚
â”‚    - Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±                                          â”‚
â”‚    - Ø§Ù„ÙˆØµÙ                                                   â”‚
â”‚    - Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©                                              â”‚
â”‚    - Ø§Ù„Ù…Ø¯Ø©                                                    â”‚
â”‚    - Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Code Flow:**
```typescript
// 1. Ø¬Ù„Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
const testsSnapshot = await getDocs(collection(db, "tests"));
const testsData = testsSnapshot.docs.map((doc) => ({
  id: doc.id,
  ...doc.data(),
}));

// 2. Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
const handleEditTest = async (test: Test) => {
  const privateContentRef = doc(db, "tests", test.id, "private", "content");
  const privateContentDoc = await getDoc(privateContentRef);
  if (privateContentDoc.exists()) {
    const questionsData = privateContentDoc.data().questionsData || [];
    // Ø§Ø³ØªØ®Ø¯Ø§Ù… questionsData ÙÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  }
};
```

---

### ğŸ‘¤ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ

#### 1ï¸âƒ£ **Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Page - Tests List                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©:                                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Firestore Read                            â”‚             â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚    â”‚ Collection: educationalLevels           â”‚             â”‚
â”‚    â”‚ Query: orderBy("createdAt", "asc")      â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Security Rules:                          â”‚             â”‚
â”‚    â”‚   allow read: if true; âœ… Ù„Ù„Ø¬Ù…ÙŠØ¹         â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                              â”‚
â”‚ 2. Ø¬Ù„Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª:                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Firestore Read                            â”‚             â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚    â”‚ Collection: tests                        â”‚             â”‚
â”‚    â”‚ Filter: level == selectedEducationalLevelâ”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Security Rules:                          â”‚             â”‚
â”‚    â”‚   allow read: if true; âœ… Ù„Ù„Ø¬Ù…ÙŠØ¹         â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©:                       â”‚             â”‚
â”‚    â”‚   - title (Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±)              â”‚             â”‚
â”‚    â”‚   - description (Ø§Ù„ÙˆØµÙ)                 â”‚             â”‚
â”‚    â”‚   - duration (Ø§Ù„Ù…Ø¯Ø©)                     â”‚             â”‚
â”‚    â”‚   - questions (Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©)              â”‚             â”‚
â”‚    â”‚   âŒ questionsData (ØºÙŠØ± Ù…ØªØ§Ø­)            â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                              â”‚
â”‚ 3. Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª:                                          â”‚
â”‚    - Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (Ø¹Ù†ÙˆØ§Ù†ØŒ ÙˆØµÙØŒ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©)           â”‚
â”‚    - Ø²Ø± "Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Code Flow:**
```typescript
// 1. Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
const educationalLevelsQuery = query(
  collection(db, "educationalLevels"),
  orderBy("createdAt", "asc")
);
const educationalLevelsSnapshot = await getDocs(educationalLevelsQuery);

// 2. Ø¬Ù„Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
const testsSnapshot = await getDocs(collection(db, "tests"));
const testsData = testsSnapshot.docs.map((doc) => ({
  id: doc.id,
  ...doc.data(),
  questionsData: [], // ÙØ§Ø±Øº - Ø³ÙŠØªÙ… Ø¬Ù„Ø¨Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹
}));

// 3. ÙÙ„ØªØ±Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ø±Ø­Ù„Ø©
const testsForSelectedLevel = tests.filter(
  (test) => test.level === selectedEducationalLevel
);
```

#### 2ï¸âƒ£ **Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Page - Start Test                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¶ØºØ· "Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±":                            â”‚
â”‚                                                              â”‚
â”‚ 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:                                       â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Firestore Read                            â”‚             â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚    â”‚ Path: subscriptions/{userId}             â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Security Rules:                          â”‚             â”‚
â”‚    â”‚   allow read: if subscriptionId ==       â”‚             â”‚
â”‚    â”‚                request.auth.uid; âœ…      â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                              â”‚
â”‚ 3. Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©:                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Firestore Read                            â”‚             â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚    â”‚ Path: tests/{testId}/private/content    â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Security Rules Check:                    â”‚             â”‚
â”‚    â”‚   1. request.auth != null âœ…             â”‚             â”‚
â”‚    â”‚   2. exists(tests/{testId}) âœ…           â”‚             â”‚
â”‚    â”‚   3. test.level != null âœ…               â”‚             â”‚
â”‚    â”‚   4. hasValidSubscription(test.level) âœ…â”‚             â”‚
â”‚    â”‚      - subscription.endsAt > now         â”‚             â”‚
â”‚    â”‚      - subscription.educationalLevelId   â”‚             â”‚
â”‚    â”‚        == test.level                     â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©:                       â”‚             â”‚
â”‚    â”‚   - questionsData[] (Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©)    â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                              â”‚
â”‚ 4. Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:                                            â”‚
â”‚    - Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ                                           â”‚
â”‚    - Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©                                          â”‚
â”‚    - Ø²Ø± "Ø§Ù„ØªØ§Ù„ÙŠ" / "Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Code Flow:**
```typescript
// Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"
const handleStartTest = async (test: Test) => {
  // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
  if (!hasSubscription) {
    setShowMessage({ type: "subscription", show: true });
    return;
  }

  // 2. Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
  const privateContentRef = doc(db, "tests", test.id, "private", "content");
  const privateContentDoc = await getDoc(privateContentRef);
  
  if (privateContentDoc.exists()) {
    const questionsData = privateContentDoc.data().questionsData || [];
    
    // 3. ØªØ­Ø¯ÙŠØ« state
    setCurrentTestData({
      ...test,
      questionsData: questionsData,
      questions: questionsData.length,
    });
    
    // 4. Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
    setSelectedTest(test.id);
    setTestStarted(true);
    setCurrentQuestion(0);
  }
};
```

#### 3ï¸âƒ£ **Ù…Ø®Ø·Ø· ØªØ¯ÙÙ‚ ÙƒØ§Ù…Ù„ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Tests Flow Diagram                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ADMIN PANEL:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create Test  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ tests/{testId}                      â”‚
â”‚   - title, description, level       â”‚
â”‚   - questions (count)                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ tests/{testId}/private/content      â”‚
â”‚   - questionsData[]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

USER PAGE:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Select Level      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Read: tests (public data only)       â”‚
â”‚   âœ… allow read: if true             â”‚
â”‚   - title, description, questions    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Click "Start"     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check Subscription                   â”‚
â”‚   âœ… allow read: if userId matches   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Read: tests/{testId}/private/content â”‚
â”‚   âœ… hasValidSubscription(level)     â”‚
â”‚   - questionsData[]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Display Test      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª (Courses Rules)

### ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠØ©

```javascript
match /courses/{document=**} {
  allow read: if request.auth != null;
  allow write: if isAdmin();
}
```

**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:** Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø¨Ø³ÙŠØ·Ø© Ø¬Ø¯Ø§Ù‹ ÙˆÙ„Ø§ ØªØ­Ù…ÙŠ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª!

**Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯:**
- Admin Panel: ÙŠØ­ÙØ¸ `videoUrl` ÙÙŠ `courses/{courseId}/private/source` Ù…Ø¹ field `url` âœ…
- User Page: ÙŠØ­Ø§ÙˆÙ„ Ø¬Ù„Ø¨ `videoUrl` Ù…Ù† `private/source` âœ…
- Security Rules: **Ù„Ø§ ØªØ­Ù…ÙŠ** `private/source` âŒ

### âœ… Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ù…Ø«Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª)

```javascript
match /courses/{courseId} {
  // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¹Ø§Ù…Ø© (Ù„Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…)
  allow read: if true; 
  allow write: if isAdmin();

  // Ø­Ù…Ø§ÙŠØ© Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙƒÙˆØ±Ø³
  match /private/source {
    // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙˆÙ…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© (Level)
    allow read: if request.auth != null && 
                   exists(/databases/$(database)/documents/courses/$(courseId)) &&
                   get(/databases/$(database)/documents/courses/$(courseId)).data.level != null &&
                   hasValidSubscription(get(/databases/$(database)/documents/courses/$(courseId)).data.level);
    allow write: if isAdmin();
  }
}
```

### ğŸ“Š Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠ

```
courses/{courseId}
â”œâ”€â”€ title: string
â”œâ”€â”€ description: string
â”œâ”€â”€ thumbnailUrl: string
â”œâ”€â”€ duration: string
â”œâ”€â”€ level: string (ID Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©)
â”œâ”€â”€ category: string (ID Ø§Ù„ØªØµÙ†ÙŠÙ)
â”œâ”€â”€ instructor: string
â”œâ”€â”€ students: number
â”œâ”€â”€ lessons: number
â”œâ”€â”€ createdAt: timestamp
â”œâ”€â”€ updatedAt: timestamp
â””â”€â”€ private/
    â””â”€â”€ source/
        â””â”€â”€ url: string (Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø­Ù…ÙŠ)
```

**Ù…Ù„Ø§Ø­Ø¸Ø©:** Ø§Ù„ÙƒÙˆØ¯ ÙŠØ³ØªØ®Ø¯Ù… `url` ÙˆÙ„ÙŠØ³ `videoUrl` ÙÙŠ `private/source`

### ğŸ”„ Ø­Ø±ÙƒØ© Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª (Ù…Ø«Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª)

#### ÙÙŠ Admin Panel:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin Panel - Course Form                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:                                          â”‚
â”‚    - title, description, thumbnailUrl                         â”‚
â”‚    - level (ID Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©)                           â”‚
â”‚    - category (ID Ø§Ù„ØªØµÙ†ÙŠÙ)                                   â”‚
â”‚    - videoUrl (Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ)                                 â”‚
â”‚                                                              â”‚
â”‚ 2. Ø¹Ù†Ø¯ Ø§Ù„Ø­ÙØ¸:                                                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Collection: courses/{courseId}           â”‚             â”‚
â”‚    â”‚ Fields: (public data)                    â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Subcollection:                           â”‚             â”‚
â”‚    â”‚   courses/{courseId}/private/source      â”‚             â”‚
â”‚    â”‚ Fields:                                  â”‚             â”‚
â”‚    â”‚   - videoUrl: string                      â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Page - Courses List                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©                                 â”‚
â”‚ 2. Ø¬Ù„Ø¨ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª (public data only):                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Collection: courses                     â”‚             â”‚
â”‚    â”‚ Filter: level == selectedLevel          â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Security Rules:                          â”‚             â”‚
â”‚    â”‚   allow read: if true; âœ… Ù„Ù„Ø¬Ù…ÙŠØ¹        â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©:                       â”‚             â”‚
â”‚    â”‚   - title, description, thumbnailUrl     â”‚             â”‚
â”‚    â”‚   - duration, instructor                 â”‚             â”‚
â”‚    â”‚   âŒ videoUrl (ØºÙŠØ± Ù…ØªØ§Ø­)                 â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                              â”‚
â”‚ 3. Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙƒÙˆØ±Ø³":                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Check Subscription                        â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                              â”‚
â”‚ 4. Ø¬Ù„Ø¨ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ:                                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Path: courses/{courseId}/private/source  â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Security Rules Check (Ø­Ø§Ù„ÙŠØ§Ù‹):          â”‚             â”‚
â”‚    â”‚   âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚ÙˆØ§Ø¹Ø¯ Ù…Ø­Ø¯Ø¯Ø© - Ù…ÙØªÙˆØ­ Ù„Ù„Ø¬Ù…ÙŠØ¹! â”‚             â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Security Rules Check (Ù…Ø·Ù„ÙˆØ¨):           â”‚             â”‚
â”‚    â”‚   1. request.auth != null âœ…             â”‚             â”‚
â”‚    â”‚   2. exists(courses/{courseId}) âœ…      â”‚             â”‚
â”‚    â”‚   3. course.level != null âœ…            â”‚             â”‚
â”‚    â”‚   4. hasValidSubscription(course.level) âœ…â”‚            â”‚
â”‚    â”‚                                          â”‚             â”‚
â”‚    â”‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©:                       â”‚             â”‚
â”‚    â”‚   - url (Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ù† private/source)â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ§Ù„ÙƒÙˆØ±Ø³Ø§Øª

| Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (Tests) | Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª (Courses) |
|--------|-------------------|-------------------|
| **Public Data** | âœ… title, description, duration, questions | âœ… title, description, thumbnailUrl, duration, instructor |
| **Protected Data** | `private/content` (questionsData) | `private/source` (videoUrl) |
| **Read Public** | `allow read: if true;` | `allow read: if true;` (Ù…Ø·Ù„ÙˆØ¨) |
| **Read Protected** | `hasValidSubscription(level)` | `hasValidSubscription(level)` (Ù…Ø·Ù„ÙˆØ¨) |
| **Write** | `isAdmin()` | `isAdmin()` |
| **Field Name** | `level` (string ID) | `level` (string ID) |
| **Structure** | `tests/{testId}/private/content` | `courses/{courseId}/private/source` |

### ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©:

1. **Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª:**
   - Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹ âœ…
   - Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù…Ø­Ù…ÙŠØ© Ø¨Ù€ `hasValidSubscription()` âœ…
   - Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ù…Ø·Ø¨Ù‚Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ âœ…

2. **Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª:**
   - Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙ‚Ø· âœ… (Ø­Ø§Ù„ÙŠØ§Ù‹: `request.auth != null`)
   - Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ **ØºÙŠØ± Ù…Ø­Ù…ÙŠ** âŒ (ÙŠØ¬Ø¨ Ø¥ØµÙ„Ø§Ø­Ù‡)
   - Ø§Ù„ÙƒÙˆØ¯ ÙŠØ­Ø§ÙˆÙ„ Ø¬Ù„Ø¨ `private/source` Ù„ÙƒÙ† Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ù„Ø§ ØªØ­Ù…ÙŠÙ‡ âŒ
   - ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ù„Ø­Ù…Ø§ÙŠØ© `private/source` Ù…Ø«Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª

---

## âœ… Ø§Ù„ØªÙˆØµÙŠØ§Øª

### 1. ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª:

```javascript
match /courses/{courseId} {
  // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¹Ø§Ù…Ø© (Ù„Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…)
  allow read: if true; 
  allow write: if isAdmin();

  // Ø­Ù…Ø§ÙŠØ© Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙƒÙˆØ±Ø³
  match /private/source {
    allow read: if request.auth != null && 
                   exists(/databases/$(database)/documents/courses/$(courseId)) &&
                   get(/databases/$(database)/documents/courses/$(courseId)).data.level != null &&
                   hasValidSubscription(get(/databases/$(database)/documents/courses/$(courseId)).data.level);
    allow write: if isAdmin();
  }
}
```

**Ù…Ù„Ø§Ø­Ø¸Ø©:** Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠØ³ØªØ®Ø¯Ù… `url` ÙÙŠ `private/source` ÙˆÙ„ÙŠØ³ `videoUrl`

### 2. Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ:

- âœ… Admin Panel: ÙŠØ­ÙØ¸ `videoUrl` ÙÙŠ `courses/{courseId}/private/source` Ù…Ø¹ field `url`
- âœ… User Page: ÙŠØ­Ø§ÙˆÙ„ Ø¬Ù„Ø¨ `url` Ù…Ù† `private/source` Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
- âŒ Security Rules: **Ù„Ø§ ØªØ­Ù…ÙŠ** `private/source` - ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø£Ø¹Ù„Ø§Ù‡

### 3. Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:

1. ØªØ­Ø¯ÙŠØ« `firestore.rules` Ø¨Ø¥Ø¶Ø§ÙØ© Ù‚ÙˆØ§Ø¹Ø¯ `private/source` Ù„Ù„ÙƒÙˆØ±Ø³Ø§Øª
2. Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ `level`
3. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ `private/source` Ù…Ø¹/Ø¨Ø¯ÙˆÙ† Ø§Ø´ØªØ±Ø§Ùƒ

---

## ğŸ“Œ Ø§Ù„Ø®Ù„Ø§ØµØ©

1. **Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª:** ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ù…Ø¹ Ø­Ù…Ø§ÙŠØ© ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…Ø­ØªÙˆÙ‰
2. **Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª:** ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆÙ‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªØ·Ø¨ÙŠÙ‚ Ù†ÙØ³ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ù…Ø§ÙŠØ©
3. **Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ù…ÙˆØ­Ø¯:** Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ Ø§Ù„Ù†Ù…Ø· (`public data` + `private/content` Ø£Ùˆ `private/source`) ÙŠØ³Ù‡Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø© ÙˆØ§Ù„Ø£Ù…Ø§Ù†

---

**ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:** 2025-11-22  
**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:** 2025-11-22

